<!DOCTYPE html>
<html>
  <head>
    <title>Myapp</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAT6Y916z1FrcjWZ0Z6J12iMJQPkwUEwWk&callback=initMap"
    async defer></script>

  </head>


  <body>
<h1>Welcome to Instagaram</h1>
<% if current_user %>
  Logged in as <%= current_user.email %>.
  <%= link_to'Log Out', logout_path %>
<% else %>
  <%= link_to 'Sign Up', signup_path %> or 
  <%= link_to 'Log In', login_path %>
  <%= link_to "Sign in with Google", "/auth/google_oauth2", id: "sign_in" %>
<% end %>

<p id=”notice”><%= notice %></p>

<h2>Upload Photos to Instagram</h2>
<%= link_to 'All Entries', controller: 'entries' %>
<%= link_to 'New Entries', controller: 'entries' %>


<h2>Search  </h2>
<%= form_tag(search_path, method: :get ) do %>
  Captions: <%= text_field_tag :description %><br/>
  <%= submit_tag 'Search', name: nil %>
<% end %>


<h2>Users</h2>
<% User.all.each do |user| %>
  <ul>
    <li>id: <%= user.id %></li>
    <li>email:  <%= link_to user.email, user_path(user) %></li>
  </ul>

<% end %>



<h1>Cloneinstagaram</h1>
<p>Back to Square One, where it all began. Share to the world and have fun.</p>



  </body>
  <script>
  $("#entries-search").on("keyup", function(){
    autocomplete()
  });
  function autocomplete(){
    $.ajax({
      url: '/entries',
      type: 'GET',
      data: $("#entries-search").serialize(), //takes the form data and authenticity toke and converts it into a standard URL
      contentType: 'application/json; charset=utf-8', // this
      dataType: 'json', //specify what type of data you're expecting back from the servers
      error: function() {
          console.log("Something went wrong");
      },
      success: function(data) { //this data is what is being sent back from listings
        console.log(data)
        $("#list").html("");
        data.forEach(function(element) {
          var option = document.createElement("option");
          option.value = element;
          //append option to list
          $("#list").append(option);
        });
      }
    });
  }
</script>
</html>
